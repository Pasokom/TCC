/** função pega como parametro a data do lembrete ( data de inicio ), o tipo de recorrencia e a recorrencia 
   retorna a data calculando a recorrencia de acordo com o tipo passado
 **/
DELIMITER // 
DROP FUNCTION IF EXISTS CALCULO_RECORRENCIA;
CREATE FUNCTION CALCULO_RECORRENCIA (DATA_LEMBRETE DATETIME, TIPO_RECORRENCIA INT , RECORRENCIA INT)
RETURNS DATETIME 
BEGIN 
    DECLARE RETORNO DATETIME; 
   
     IF TIPO_RECORRENCIA = 0 OR TIPO_RECORRENCIA IS NULL THEN 
           SET RETORNO = DATA_LEMBRETE;
     END IF; 
    
     IF TIPO_RECORRENCIA = 1 THEN 
         SET RETORNO = DATE_ADD(DATA_LEMBRETE, INTERVAL RECORRENCIA DAY);
     END IF ;
     
     IF TIPO_RECORRENCIA  = 2 THEN 
         SET RETORNO = DATE_ADD(DATA_LEMBRETE, INTERVAL RECORRENCIA WEEK);
     END IF ; 
     
     IF TIPO_RECORRENCIA = 3 THEN 
        SET RETORNO = DATE_ADD(DATA_LEMBRETE, INTERVAL RECORRENCIA MONTH);
     END IF; 
     
     IF TIPO_RECORRENCIA = 4  THEN 
        SET RETORNO = DATE_ADD(DATA_LEMBRETE, INTERVAL RECORRENCIA YEAR);
     END IF ; 
       
       RETURN (RETORNO);
   END 
//


